---
title: "Урок 1. Введение во фреймворк Shiny"
output:
  pdf_document: default
  html_document:
    df_print: paged
header-includes:
- \usepackage[russian]{babel}
- \usepackage{hyperref}
- \hypersetup{ colorlinks = true, urlcolor = blue}
---

Как мы уже убедились, в современном анализе данных не обойтись без визуализации. Она позволяет нам увидеть закономерности в данных, навести на мысль о характере их распределения или наличия связей между показателями. Обычно под визуализацией понимают графики, но к ней можно отнести таблицы, карты и схемы. Часто средства визуализации нам нужны не столько для себя, сколько для других: для коллег, которые слушают презентацию наших результатов, для пользователей, которым  интересна некоторая статистика, например, частота посещений сайта или результаты игры, но которым не хочется смотреть на скучный набор чисел. Без инфографики и аналитических панелей – дэшбордов - сейчас никуда. Особенно полезны и интересны интерактивные аналитические панели – те, которые могут взаимодействовать с пользователем: реагировать на то, какой показатель для описания он выберет, какую цветовую гамму предпочтет, какие наблюдения его интересуют.  В R возможность создавать такие панели есть, и для этого существует библиотека Shiny. 

На самом деле Shiny – это не только библиотека, это целый проект. Он предлагает не только программные средства для создания аналитических панелей и приложений, но и ресурсы для хостинга и развития приложений онлайн. Кроме того, у проекта есть свой сайт <http://shiny.rstudio.com> и галерея с примерами дэшбордов.

Сначала установим библиотеку shiny для запуска готовых приложений shiny и создания своих:

```{r, eval=FALSE}
install.packages("shiny")
```

Обратимся к библиотеке:

```{r, message=FALSE, warning=FALSE}
library(shiny)
```

Теперь в качестве первого знакомства запустим готовое приложение `"01_hello"`, которое предварительно загружено в библиотеку.

```{r, eval=FALSE}
runExample("01_hello")
```

На это приложение можно смотреть как на шаблонный файл с кодом для своего дэшборда, своего приложения. После запуска открывается отдельное окно с дэшбордом, с которым можно поэкспериментировать, а также с кодом для его создания. Сначала посмотрим на сам дэшборд, а с кодом поработаем в следующем уроке. 

Здесь у нас есть две части: гистограмма и «бегунок», который позволяет пользователю самому выбрать число столбцов в гистограмме. Можем попробовать! 

Это все красиво, но логичным образом возникает вопрос: а как создать файл со своим приложением? Сейчас будем разбираться.

Так же как при создании проекта или сайта, файлы с кодом и данными для приложения должны храниться в отдельной папке. Удобнее создать ее в рабочей директории. Перед работой узнаем, какая директория является рабочей:

```{r}
getwd()
```

В этой папке на следующем шаге мы создадим папку для приложения. Заходим в меню: *File — New file — Shiny Web App*.

Назовем приложение, а следовательно, и папку, *my-app*. Выберем настройки по умолчанию, один файл для кода (*single file*), позже обсудим, почему может возникнуть необходимость разделить его на две части. 

Открылся шаблонный файл с примером кода для приложения, пример другой, но тоже с гистограммой. Первая и последняя строки кода в файле очень важны.
Первая строка:

```{r,eval=FALSE}
library(shiny)
```

Последняя строка:

```{r, eval=FALSE}
shinyApp(ui = ui, server = server)
```

Без этих строк кода приложение не запустится, так как R не поймет, из какой библиотеки брать функции, и не получит явной команды запустить приложение. Запускаем – кликаем на кнопку *Run App*.

Опять дэшборд открывается в новом окне RStudio, однако на него можно посмотреть в браузере. Когда приложение запущено, в консоли RStudio отображается адрес локальной ссылки `http://127.0.0.1:7694`, которую можно скопировать в браузер. Тогда на дэшборд можно смотреть как на интерактивную html-страницу. 

Итак, сами на дэшборд посмотрели, знаем, где файл лежит на компьютере (в папке *my-app* в рабочей директории) и где его искать в браузере. Как показать его другим? Опубликовать. Для этого вернемся в окно RStudio и нажмем кнопку *Publish*. Создадим аккаунт на сайте проекта Shiny. 

Проект предлагает место на сервере, где можно хранить свои веб-приложения и делиться с другими. Бесплатный аккаунт позволяет создавать не более 5 активных приложений и на каждое приложение приходится не более 25 часов суммарного использования пользователями (например, 50 пользователей могут «играть» с нашей гистограммой в течение получаса каждый). При желании можно рассмотреть другие тарифные планы.

После создания аккаунта, выбираем его и нажимаем *Publish*. В консоли описываются все процессы и по завершению наше приложение, наш дэшборд, публикуется на сайте в открытом доступе. 

Всё! Этой ссылкой (в моем случае <https://alla-tambovtseva.shinyapps.io/my-app/>) можно спокойно делиться с коллегами или пользователями. На этом мы завершим введение в Shiny и в следующем уроке будем изучать приложения изнутри.
