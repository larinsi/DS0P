---
title: "Урок 5. Числовые векторы и операции с ними"
output:
  pdf_document: default
  html_document:
    df_print: paged
header-includes:
- \usepackage[russian]{babel}
- \usepackage{hyperref}
- \hypersetup{ colorlinks = true, urlcolor = blue}
---

В этом и в следующем уроках мы поговорим о ключевой структуре данных в R – о векторе. Вектор – это просто некоторый список значений одного типа, аналог массивов в Python. Например, такой:

```{r}
v <- c(2, 5, 8)
```

Вектор создается с помощью оператора `c()`, а элементы вектора перечисляются в скобках через запятую.

Почему векторы в R важны и почему мы не можем начать с чего-то более интересного, например, с датафреймов (таблиц с данными, в R они сохраняются в объект data.frame)? Дело в том, что вектор является основной единицей хранения данных и даже датафрейм воспринимается R как набор векторов: каждый столбец — отдельный вектор. То же происходит и со статистическими выдачами: их внутреннее представление часто выглядит как набор векторов, например, вектор с коэффициентами модели,  вектор с техническими характеристиками модели и вектор с результатами.

Начнем наше знакомство с векторами с числовых векторов. Создадим вектор со значениями объемов продаж разных фирм (в тысячах) и посмотрим на него:

```{r}
sales <- c(30, 80, 24, 67, 90, 32, 24)
sales
```

Посчитаем число элементов — длину вектора:

```{r}
length(sales)
```

Да, в Python в списках было бы просто `len()`, главное не перепутать.

Теперь выберем первый элемент вектора по его индексу:

```{r}
sales[1] # индекс в квадратных скобках
```

Обратите внимание, в отличие от Python и других языков программирования нумерация в R начинается с единицы, а не с нуля. Если мы вызовем нулевой элемент, R не выдаст ошибку, а покажет пустой элемент:

```{r}
sales[0]
```

Здесь указан `numeric()`, поскольку вектор состоит из чисел.

В R, в отличие от Python, нет удобной возможности отсчитывать элементы с конца, поэтому последний элемент произвольного вектора придется выбирать так:

```{r}
sales[length(sales)] # через длину вектора
```

Изменить элемент вектора просто: нужно выбрать его по индексу и присвоить новое значение:

```{r}
sales[1] <- 44
sales
```

Для выбора нескольких элементов используются срезы:

```{r}
sales[1:3] # выберем элементы с первого по третий
```

В отличие от Python, оба конца среза включаются.

Полуоткрытые и открытые срезы, к сожалению, не работают:

```{r, eval=FALSE}
sales[2:] # ошибка
```

```
## Ошибка: неожиданный ']' in "sales[2:]"
```

В квадратных скобках мы можем указывать не только индексы элементов, но и условия, в соответствии с которыми мы хотим отфильтровать элементы. Например, выберем все элементы, равные 24. Для этого укажем название вектора в скобках и пропишем условие равенства (как вы помните из Python, для проверки равенства используется двойной знак `=`):

```{r}
sales[sales == 24]
```

Или все элементы не более 30:

```{r}
sales[sales <= 30]
```

Конечно, условия в скобках можно сочетать, делать их более сложными, но давайте обсудим это позже, в отдельном уроке.

Если нам нужно узнать индекс конкретного элемента, пригодится функция `which()` и условие равенства. Узнаем, на каких местах в векторе `sales` стоит число 24:

```{r}
which(sales == 24)
```

Таким же образом можно узнавать индексы элементов, которые удовлетворяют определенным условиям. Например, узнаем, на каких местах стоят элементы больше 30:

```{r}
which(sales > 30)
```

В конце этого урока хотелось бы показать, что вектора не только важны для понимания структур данных в R, но и очень удобны на практике. Если мы хотим применить некоторую операцию к каждому элемента вектора, нам не понадобится никаких вспомогательных конструкций, мы сможем применить ее ко всему вектору сразу (*векторизованные операции*). Например, возведем каждый элемент вектора `sales` в квадрат:

```{r}
sales ** 2
```

Или сложим два вектора одинаковой длины:

```{r}
v1 <- c(0, 1, 4)
v2 <- c(8, 9, 2)
v1 + v2  # элементы суммируются попарно
```

Или вычтем из первого вектора второй:

```{r}
v1 - v2
```

Или применим какую-нибудь функцию, например, округлим все значения в векторе:

```{r}
round(c(3.4, 5.7, 0.1))
```

Что еще можно делать с числовыми векторами? Находить сумму всех элементов или их произведение:

```{r}
v2
sum(v2) # сумма
prod(v2) # произведение
```

Сортировать, как в порядке возрастания, так и в порядке убывания:

```{r}
sort(v2)
sort(v2, decreasing = TRUE) # убывание, опция decreasing
```

Скорее всего, многие действия выше напомнили вам операции с массивами NumPy в Python. Это неслучайно. Действительно, о векторах можно думать как об одномерных массивах. Это наборы элементов одного типа (мы работали с векторами, полностью состоящими из чисел), над которыми можно выполнять векторизованные операции. В следующем уроке мы подробно поговорим о разных типах данных в R, а пока предлагаю поработать с векторами и выполнить практическое задание. Желаю удачи!
