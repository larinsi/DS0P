---
title: "Практическое задание 5"
output:
  pdf_document: default
  word_document: default
header-includes: \usepackage[russian]{babel}
---

\begin{center}
\large{\textit{Практическое задание не сдается на проверку и не оценивается.}}
\end{center}

Для выполнения задания вам потребуется познакомиться с двумя полезными функциями, одна из которых позволяет склеивать строки, а другая — создавать векторы из повторяющихся значений. Рассмотрим две задачи.

**Задача 1.** Для таблицы необходимо создать столбец с идентификаторами пользователей вида "user_01". Всего пользователей 120, но их число может меняться.

**Решение.** Для удобства сохраним число пользователей в переменную, чтобы при его изменении не пришлось переписывать весь код.

```{r}
n <- 120
```

Вспомним, как создать последовательность из целых чисел:

```{r}
nums <- 1:n
head(nums) # head - первые несколько элементов
```

Для склеивания строк (или строк и чисел) понадобится функция `paste()`. Посмотрим на пример:

```{r}
paste("new", "user", 1)
```

В скобках перечисляются элементы, которые мы хотим склеить в одну строку. По умолчанию в качестве разделителя используется пробел. Если нам нужен другой разделитель, понадобится аргумент `sep`:

```{r}
paste("new", "user", 1, sep="-")
```

Внутри функции `paste()` можно указывать не только отдельные строки или числа, но и векторы. «Приклеим» в начало каждого элемента вектора `nums` слово "user":

```{r}
users.tab <- paste("user", nums, sep="_")
head(users.tab) # задача решена!
```


**Задача 2.** Имеются 40 пользователей — участников эксперимента. Данные устроены так: сначала идут характеристики респондентов из группы A (их 20), затем — из группы B (их тоже 20). Необходимо создать столбец с идентификаторами такого вида: A1, A2, ..., A20, B1, B2, ..., B20.

**Решение. ** Для решения этой задачи нам понадобится функция `rep()`. Она создает последовательности, повторяя элемент или вектор элементов нужное число раз. Например, так:

```{r}
rep("R", 5)
```

Или так (дублируем вектор `c(1, 4, 5)`):

```{r}
rep(c(1, 4, 5), 2)
```

Если мы хотим повторить каждый элемент вектора несколько раз, например, получить подряд две 1, две 4 и две 5, нам понадобится аргумент `each`:

```{r}
rep(c(1, 4, 5), each=2)
```

Теперь применим полученные знания к решению этой задачи. Сначала создадим вектор с числами 1...20, 1...20:

```{r}
nn <- rep(1:20, 2)
nn
```

Теперь создадим последовательность из 20 букв A и 20 букв B:

```{r}
ab <- rep(c("A", "B"), each = 20)
ab
```

Здесь опция `each = 20` означает, что мы хотим сначала 20 раз повторить первую букву в векторе, а затем 20 раз вторую. 

Наконец, склеим полученные результаты:

```{r}
paste(ab, nn, sep="")
```


1. Представьте, что вам для отчета необходимо получить следующую таблицу: 

| No | City            | District       |
|----|-----------------|----------------|
| N1 | Москва          | Басманный      |
| N2 | Москва          | Красносельский |
| N3 | Москва          | Басманный      |
| N4 | Москва          | Красносельский |
| N5 | Санкт-Петербург | Адмиралтейский |
| N6 | Санкт-Петербург | Центральный    |
| N7 | Санкт-Петербург | Адмиралтейский |
| N8 | Санкт-Петербург | Центральный    |

Создайте три вектора, которые могли бы послужить столбцами в такой таблице. Объедините их в датафрейм. Создавать вектора «вручную», просто перечисляя одинаковые элементы через запятую, нельзя: на практике обычно сталкиваемся с гораздо большим объемом данных и выполнять действия вручную нерационально.

```{r}
No <- paste(rep("N", 8), 1:8, sep="")
City <- rep(c("Москва", "Санкт-Петербург"), each=4)
District <- c(rep(c("Басманный", "Красносельский"), 2), rep(c("Адмиралтейский", "Центральный"), 2))
dat <- cbind.data.frame(No, City, District)
dat
```


*Подсказка:* для столбца *District* здесь пригодится конкатенация (склеивание) векторов. Приписать в конец одного вектора элементы другого можно с помощью уже известной функции `c()`:

```{r}
# пример
a <- c(2, 3)
b <- c(0, 7)

c(a, b)
```


2. Создайте (любым образом) матрицу, которая содержит число договоров, заключенных 3 компаниями за 6 месяцев:

```{r, echo=FALSE}
company.1 <- c(223, 100, 350, 122, 99, 346)
company.2 <- c(563, 478, 501, 497, 102, 421)
company.3 <- c(156, 187, 122, 134, 53, 190)
m <- rbind(company.1, company.2, company.3)
m
```

2.1. Выведите общее число договоров, подписанных каждой компанией за все 6 месяцев.

2.2. Выведите общее число договоров, подписанных компаниями за каждый месяц.

2.3. Некоторые данные по компаниям оказались ошибочными. Измените некоторые элементы матрицы таким образом, чтобы она приобрела следующий вид:

```{r, echo=FALSE}
m[2, 3] <- 517
m[1, 2] <- 110
m[3, 3] <- 127
m
```


